<div class="container text-evaluation">
    <div class="row">
        <div class="col-lg-1"></div>
        <div class="col-sm-12 col-md-12 col-lg-10">
            <div class="row">
                <div class="col">
                    <h2 class="naranja">Seguro Vida Ley</h2>
                </div>
                <div class="col" style="text-align: right;">
                <span class="text-primary">Fecha actual: {{ currentDate | date: "dd/MM/yyyy" }}</span>
                </div>
            </div>
            <hr class="bg-hr">
            <div class="row">
                <div class="col">
                <h5>Estimado cliente : <b>{{ tramite.NOMBRE_RAZON }}</b></h5>
                <p>Se ha registrado un trámite N° {{ tramite.NID_TRAMITE }} para la transacción de
                  {{ QuotationData.TypeTransac }} de Póliza:
                  {{ QuotationData.PolicyNumber }}</p>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="alert alert-secondary p-1">
                    <h5 class="naranja m-1">
                      Datos de {{ QuotationData.TypeTransac }}
                    </h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-8 col-sm-12">
                    <div class="row" *ngIf="sAbrTran == 'RE'">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-sm-12"><p class="descript">Vigencia Anterior:</p></div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <p>Vigencia de póliza : </p>
                                </div>
                                <div class="col-md-8 descript">
                                    <p>{{dataRenovacion.DSTARTDATE | date: "dd/MM/yyyy"}} - {{dataRenovacion.DEXPIRDAT | date: "dd/MM/yyyy"}}</p>
                                </div>
                                <div class="col-md-4">
                                    <p>Vigencia de asegurados : </p>
                                </div>
                                <div class="col-md-8 descript">
                                    <p>{{dataRenovacion.DSTARTDATE_ASE | date: "dd/MM/yyyy"}} - {{dataRenovacion.DEXPIRDAT_ASE | date: "dd/MM/yyyy"}}</p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12"><p class="descript">Vigencia a renovar:</p></div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <p>Vigencia de póliza : </p>
                                </div>
                                <div class="col-md-8 descript">
                                    <p>{{tramite.EFECTO_COTIZACION | date: "dd/MM/yyyy"}} - {{tramite.EXPIRACION_COTIZACION |
                                        date: "dd/MM/yyyy"}}</p>
                                </div>
                                <div class="col-md-4">
                                    <p> Vigencia de asegurados :</p>
                                </div>
                                <div class="col-md-8 descript">
                                    <p>{{tramite.EFECTO_ASEGURADOS | date: "dd/MM/yyyy"}} - {{tramite.EXPIRACION_ASEGURADOS | date: "dd/MM/yyyy"}}</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12"><hr style="margin-top: 0;"/></div>
                    </div>
                     <div
                      class="row"
                      *ngIf="
                       nTransac == 2 ||
                       nTransac == 8 ||
                       sAbrTran == 'DE' ||
                       nTransac == 3 ||
                       nTransac == 1 ||
                       nTransac == 14
                       "
                      >
                        <div class="col-md-4">
                            <p>Vigencia de póliza : </p>
                        </div>
                        <div class="col-md-8 descript">
                            <p>{{tramite.EFECTO_COTIZACION | date: "dd/MM/yyyy"}} - {{tramite.EXPIRACION_COTIZACION |
                                date: "dd/MM/yyyy"}}</p>
                        </div>
                    </div>
                    <div class="row" *ngIf="nTransac == 2 || nTransac == 8">
                        <div class="col-md-4">
                            <p> Vigencia de asegurados :</p>
                        </div>
                        <div class="col-md-8 descript">
                            <p>{{tramite.DSTARTDATE_ASEG_VL |date: "dd/MM/yyyy"}} - {{tramite.EXPIRACION_ASEGURADOS | date: "dd/MM/yyyy"}}</p>
                        </div>
                    </div>
                    <div
                      class="row"
                      *ngIf="nTransac == 3 || nTransac == 1 || nTransac == 14"
                     >
                        <div class="col-md-4">
                            <p> Vigencia de asegurados :</p>
                        </div>
                        <div class="col-md-8 descript">
                            <p>{{tramite.EFECTO_ASEGURADOS | date: "dd/MM/yyyy"}} - {{tramite.EXPIRACION_ASEGURADOS | date: "dd/MM/yyyy"}}</p>
                        </div>
                    </div>
                    <div class="row" *ngIf="sAbrTran == 'DE'">
                        <div class="col-md-4">
                            <p> Vigencia de asegurados :</p>
                        </div>
                        <div class="col-md-8 descript">
                            <p>{{tramite.EFECTO_ASEGURADOS | date: "dd/MM/yyyy"}} - {{tramite.EXPIRACION_ASEGURADOS |
                                date: "dd/MM/yyyy"}}</p>
                        </div>
                    </div>
                    <div class="row" *ngIf="nTransac == 2 || nTransac == 8">
                        <div class="col-md-4">
                            <p>Fecha de {{QuotationData.TypeTransac}} :</p>
                        </div>
                        <div class="col-md-8 descript">
                            <p>{{tramite.EFECTO_ASEGURADOS | date: "dd/MM/yyyy"}} - {{tramite.EXPIRACION_ASEGURADOS |
                                date: "dd/MM/yyyy"}}</p>
                        </div>
                    </div>
                    <div class="row" *ngIf="nTransac == 3">
                        <div class="col-md-4">
                            <p>Fecha de {{QuotationData.TypeTransac}} :</p>
                        </div>
                        <div class="col-md-8 descript">
                            <p>{{tramite.FECHA_EXCLUSION | date: "dd/MM/yyyy"}} - {{tramite.EXPIRACION_ASEGURADOS |
                                date: "dd/MM/yyyy"}}</p>
                        </div>
                    </div>
                    <div class="row" *ngIf="nTransac == 8">
                        <div class="col-md-4">
                            <p>Tipo de endoso:</p>
                        </div>
                        <div class="col-md-8 descript">
                            <p>{{tipoEndoso}}</p>
                        </div>
                    </div>
                    <div class="row" *ngIf="sAbrTran == 'DE'">
                        <div class="col-md-4">
                            <p>Declaración :</p>
                        </div>
                        <div class="col-md-8 descript">
                            <p> {{datoDeclaracion}} </p>
                        </div>
                    </div>
                    <div class="row" [hidden]="(nTransac == 8 && tramite.NTYPE_END != 2)">
                        <div class="col-md-4">
                            <p>Tasa por categoría:</p>
                        </div>            
                    </div>

                    <div class="row" [hidden]="(nTransac == 8 && tramite.NTYPE_END != 2)">
                        <div class="col-md-8 descript">
                            <div class="row">
                                <div class="col-md-4"><p>Categorias</p></div>                  
                                <div class="col-md-4"><p>Tasa %</p></div>
                                <div class="col-md-4"><p>Rango de edad</p></div>
                            </div>                
                            <div class="row" *ngFor="let item of AuthorizedList">
                                <div class="col-md-4"><p>{{ item.CategoryAuthorized }}:</p></div>              
                                <div class="col-md-4"><p>{{ item.RateAuthorized }}&nbsp;&nbsp;%</p></div>
                                <div class="col-md-4"><p>{{ item.SRANGO_EDAD }}</p></div>
                            </div>
                        </div>
                    </div>
                    <div class="row" *ngIf="nTransac != 3 && nTransac !=8">
                        <div class="col-md-4">
                            <p>Plan:</p>
                        </div>
                        <div class="col-md-8 descript">
                            <p>{{tramite.SDES_PLAN}}</p>
                        </div>
                    </div>
                    <!--INI COMISION VL -->
                    <div class="row">
                        <div class="col-md-4">
                            <p>Comisión:</p>
                        </div>
                        <div class="col-md-8 descript">
                            <p> {{sComissionVL}}</p>
                        </div>
                    </div>
                    <!--FIN COMISION VL -->
                </div>
                <div class="col-md-4">
                    <div class="row">
                        <div class="col">
                            <p class="align-self-end">
                              <a class="text-primary" *ngIf="nTransac != 8" (click)="getTramaFile()" role="button"
                                style="cursor: pointer;">
                                <u>Descarga el listado de asegurados.</u></a>
                              <a class="text-primary" *ngIf="nTransac == 8" (click)="getTramaFileEndoso()" role="button"
                                style="cursor: pointer;"><u>Descarga el listado de asegurados.</u></a>
                            </p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                          <div class="align-self-end" *ngIf="
                            nTransac == 2 ||
                            nTransac == 4 ||
                            nTransac == 1 ||
                            nTransac == 14">
                          <a class="text-primary" (click)="getCoverDetail()" role="button" style="cursor: pointer;">
                            <u>Descarga el detalle de coberturas.</u></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-sm-12">
                <div class=""></div>
                <div></div>
            </div>
            <div class="alert alert-secondary p-1">
                <h5 class="naranja m-1">Datos de facturación</h5>
            </div>
            <p *ngIf="nTransac == 8 && AuthorizedDetailList[2].AmountAuthorized <= 0">Este tipo de Endoso no genera un cobro adicional, o devolución.</p>
            <p *ngIf="nTransac != 3 && nTransac != 8">
                Frecuencia de pago: {{tramite.DES_FREQ_PAGO}}
            </p>
            <p *ngIf="nTransac == 3">
                * Tipo de devolución: MENSUAL
            </p>
            <div class="alert alert-secondary">
                <div class="row">
                    <div class="col-sm-8">

                    </div>
                    <p class="col-auto mr-auto">Dirección: {{tramite.DIRECCION}} </p>

                    <div class="col-sm-4">
                        <div class="row" *ngIf="nTransac == 3">
                            <div class="col-md-12 text-right mb-2">
                                <b>Monto a devolver</b>
                            </div>
                        </div>
                        <div class="row">
                            <p class="col-auto mr-auto">Prima neta:</p>
                            <p class="col-auto">{{symbolMoney}}&nbsp;{{AuthorizedDetailList[0].AmountAuthorized | number : '1.2-2'}}</p>
                        </div>
                        <div class="row">
                            <p class="col-auto mr-auto">IGV:</p>
                            <p class="col-auto">{{symbolMoney}}&nbsp;{{AuthorizedDetailList[1].AmountAuthorized | number : '1.2-2'}}</p>
                        </div>
                        <div class="row">
                            <p class="col-auto mr-auto">Prima neta + IGV:</p>
                            <p class="col-auto" style="font-weight: bold;">
                                {{symbolMoney}}&nbsp;{{AuthorizedDetailList[2].AmountAuthorized | number : '1.2-2'}}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <span>Comentario</span>
                    <textarea class="form-control" rows="4" placeholder="Comentario" [(ngModel)]="comment"
                        maxlength="4000"></textarea>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 pt-3">
                    <button class="btn btn-primary rounded-pill pull-right" (click)="processTransact()">
                        APROBAR
                    </button>
                    <button class="btn btn-light rounded-pill pull-right" (click)="RefuseTransact()">
                        RECHAZAR
                    </button>
                </div>
            </div>
          <div class="m-1 pt-3 pb-2 row justify-content-end"></div>
        </div>
    </div>
</div>
<div [hidden]="!isLoading" class="loadingScreen">
  <div style="display: flex; height: 100%; width: 100%">
    <i style="margin: auto; font-size: 50px" class="fa fa-spinner fa-spin"></i>
    </div>
</div>
<panel-info-pago [(abrir)]="modal.pagos" [cotizacion]="cotizacion" (confirmar)="formaPagoElegido()"
    [(isLoading)]="isLoading">
</panel-info-pago>

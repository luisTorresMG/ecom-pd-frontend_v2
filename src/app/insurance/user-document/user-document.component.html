<div class="container-fluid mx-0 my-0 px-0 py-0" *ngIf="!rucisvalid">
  <div class="row mx-0 my-0 px-0 py-0">
    <div class="col-lg-12 mx-0 my-0 px-0 py-0 steps">
      <app-show-steps [NSTEP]="1"></app-show-steps>
    </div>
    <div class="bc-1 col-lg-6 mx-0 my-0 px-0 py-0"></div>
    <div class="col-lg-6 mx-0 my-0 px-0 py-0 content-form">
      <form
        class="form-cotizacion"
        [@fade]="true"
        [formGroup]="form"
        (ngSubmit)="onSubmit()"
      >
        <span class="frm-title">Cotiza tu <b>seguro aquí</b></span>
        <div class="frm-inputs">
          <div class="double-inputs">
            <div class="content-input">
              <select
                class="input"
                formControlName="documentType"
                [class.error]="showError('documentType')"
              >
                <option *ngFor="let data of documentTypes" [value]="data.value">
                  {{ data.label }}
                </option>
              </select>
            </div>
            <label
              class="content-input placeholder inside"
              for="documentNumber"
              aria-placeholder="Número de documento"
              [class.active]="f.documentNumber.value"
            >
              <input
                type="text"
                class="input"
                id="documentNumber"
                [value]="isDocumentMasked ? documentMasked : f['documentNumber'].value"
                formControlName="documentNumber"
                [class.placeholder-active]="f.documentNumber.value"
                [minlength]="documentNumberLimit.min"
                [maxlength]="documentNumberLimit.max"
                (blur)="requestClientInfo()"
              />
            </label>
          </div>

          <div
            class="soat-error-message mb-0"
            *ngIf="showError('documentType')"
          >
            <ng-container *ngIf="f['documentType'].errors.required">
              <i></i><span>Necesitamos conocer tu tipo de documento</span>
            </ng-container>
          </div>
          <div
            class="soat-error-message mb-0"
            *ngIf="showError('documentNumber')"
          >
            <ng-container *ngIf="f['documentNumber'].errors.required">
              <i></i><span> Necesitamos conocer el número de tu documento</span>
            </ng-container>
            <ng-container
              *ngIf="
                (f['documentNumber'].errors.pattern ||
                  f['documentNumber'].errors.minlength ||
                  f['documentNumber'].errors.maxlength) &&
                f['documentNumber'].touched
              "
            >
              <i></i><span>Formato de documento inválido</span>
            </ng-container>
          </div>

          <label
            class="content-input placeholder inside"
            for="email"
            aria-placeholder="Correo electrónico"
            [class.active]="f.email.value"
          >
            <input
              type="text"
              autocomplete="nope"
              id="email"
              class="input"
              formControlName="email"
              [value]="isEmailMasked ? emailMasked : f['email'].value"
              [class.placeholder-active]="f.email.value"
              [maxlength]="40"
            />
            <app-email-suggestions
              [email]="f['email'].value"
              (suggestion)="emailSuggestion($event)"
            ></app-email-suggestions>
            <div class="soat-error-message" *ngIf="showError('email')">
              <ng-container *ngIf="f['email'].errors.required">
                <i></i><span>Necesitamos conocer tu correo</span>
              </ng-container>
              <ng-container *ngIf="f['email'].errors.pattern">
                <i></i><span>Formato de correo inválido</span>
              </ng-container>
            </div>
          </label>
          <ng-container *ngIf="showBirthDate">
            <label
              class="content-input placeholder inside"
              for="fechaNac"
              aria-placeholder="Fecha de Nacimiento"
              [class.active]="f.fechaNac.value"
            >
              <input
                type="text"
                id="fechaNac"
                class="input input-fechaNac"
                #dp="bsDatepicker"
                bsDatepicker
                [bsConfig]="datePickerConfig"
                formControlName="fechaNac"
                [class.placeholder-active]="f.fechaNac.value"
                readonly
              />
              <div class="soat-error-message" *ngIf="showError('fechaNac')">
                <ng-container *ngIf="f['fechaNac'].errors.required">
                  <i></i><span>Necesitamos conocer tu fecha de nacimiento</span>
                </ng-container>
              </div>
            </label>
          </ng-container>
        </div>
        <div class="checkboxes">
          <div class="checkbox-accept px-0">
            <input
              type="checkbox"
              id="policy"
              formControlName="privacy"
              (change)="emitEventPolicy()"
            />
            <label
              for="policy"
              class="checkbox-personalizado"
              [class.parpadeo]="!f.privacy.value"
            >
              <div>
                He leído y acepto el envío de comunicaciones comerciales,
                publicidad y encuestas de calidad de servicio y/o productos de
                acuerdo a lo señalado en las
                <a
                  class="policy"
                  href="https://www.protectasecurity.pe/politica-de-privacidad/"
                  target="_blank"
                  (click)="clickPrivacyPolicy()"
                >
                  Políticas de privacidad
                </a>
              </div>
            </label>
          </div>
        </div>
        <input
          type="submit"
          class="submit-form"
          [disabled]="!IsValidForm || !isDocumentInfoResponse"
          value="Cotiza aquí"
        />
        <div class="terms">
          Al presionar “Cotiza aquí” declaro conocer las
          <a
            class="policy"
            href="https://www.protectasecurity.pe/politica-de-privacidad/"
            target="_blank"
            (click)="clickPrivacyPolicy()"
          >
            Políticas de privacidad</a
          >
          y los
          <a class="policy" (click)="showTerms()">Términos y condiciones.</a>
        </div>
        <ng-container *ngIf="hasErrorSubmit">
          <small class="hasError-submit error"
            >Ocurrió un error al cotizar el producto</small
          >
        </ng-container>
      </form>
    </div>
  </div>
</div>

<div class="captcha">
  <re-captcha
    #recaptchaRef="reCaptcha"
    (resolved)="resolved($event)"
    siteKey="{{ siteKey }}"
    badge="bottomleft"
    size="invisible"
  >
  </re-captcha>
</div>

<div class="content-no-apto text-center" *ngIf="rucisvalid">
  <h2 class="title-no-apto text-center">
    Hola. Tu solicitud ha sido recepcionada por un asesor de Protecta Security,
    nos estaremos comunicando contigo en un máximo de 2 días laborables.
  </h2>
  <p class="desc-no-apto text-center">
    Contáctanos en:<br />
    Correo Electrónico: <b>cotizacionaccidentes@protectasecurity.pe</b><br />
    Estamos a tu disposición de lunes a viernes de <b>9:00 a.m. a 6:00 p.m.</b>,
    a excepción de feriados.
  </p>
  <button
    type="button"
    (click)="refreshPage()"
    class="button-home-deuda ripple stretch big mt-3"
  >
    Volver al inicio
  </button>
</div>

<ng-container *ngIf="!rucisvalid">
  <app-questions></app-questions>
</ng-container>

<div class="modal fade" bsModal #modalAdquirirSeguro="bs-modal">
  <div class="modal-dialog" role="document">
    <div class="modal-content px-0 py-0">
      <div class="modal-body">
        <span class="modal-title">
          ¿Qué necesito para adquirir el seguro?
        </span>
        <p>
          Debe acceder al seguro Accidentes Personales toda persona, empleado,
          trabajador u obrero que haya iniciado una relación laboral con una
          empresa.<br /><br />
          No obstante, el empleado, trabajador u obrero asegurado perderá la
          condición de Asegurado cuando cese el vínculo laboral con su entidad
          empleadora.<br /><br />
          El trabajador cesante puede continuar con una póliza de seguro de
          Accidentes Personales, debiendo para ello, comunicar su intención a
          Protecta Security en un plazo no mayor a 30 días calendarios de
          producido el cese laboral y prima establecida por la Compañía. La
          modalidad de seguro de su nueva póliza será individual renovable
          anual, la cual será emitida bajo nuevas condiciones según lo acordado
          entre el Asegurado y la Compañía.
        </p>
      </div>
      <button
        type="button"
        class="btn full-color btn-next-modal"
        (click)="hideModalAdquirirSeguro()"
      >
        Siguiente
      </button>
    </div>
  </div>
</div>
<ng-template #termsModalPolicy>
  <app-policy (closeaction)="closePrivacyModaPolicy()"></app-policy>
</ng-template>
<ng-template #modalTerms>
  <app-terms-ap (close)="closeModals($event)"></app-terms-ap>
</ng-template>
<ng-template #modalDocumentInvalid>
  <div class="content-modal modal-document-invalid">
    <section>
      <div class="modal-header">
        <button (click)="refreshPage()">&times;</button>
      </div>
      <div class="modal-body">
        <h4>
          Hola, no es posible validar el número de documento ingresado. Por
          favor, verificar que la información sea correcta
        </h4>
        <div class="modal-body--info">
          <p class="paragraph">Contáctanos en:</p>
          <p class="paragraph">
            Correo Electrónico: <b>cotizacionaccidentes&#64;protectasecurity.pe</b>
          </p>
          <p class="paragraph">
            Estamos a tu disposición de lunes a viernes de
            <b>9:00 a.m. a 6:00 p.m.</b>, a excepción de feriados.
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="button-default primary orange" (click)="refreshPage()">
          Volver al inicio
        </button>
      </div>
    </section>
  </div>
</ng-template>

<ng-template #modalDocumentCE>
  <div class="content-modal modal-document-ce">
    <section>
      <div class="modal-header">
        <button (click)="closeModals()">&times;</button>
      </div>
      <div class="modal-body">
        <h5>
          Por favor, revisa que los datos registrados sean los correctos antes
          de continuar:
        </h5>
        <div class="content-contratante">
          <h4 class="title-contratante">Datos del contratante</h4>
          <div class="content-items-contratante">
            <div>Número de documento</div>
            <div class="contratante-desc">{{ f["documentNumber"].value }}</div>
            <div>Correo</div>
            <div class="contratante-desc">{{ f["email"].value }}</div>
            <div>Fecha de nacimiento</div>
            <div class="contratante-desc">
              {{ f["fechaNac"].value | date : "dd/MM/yyyy" }}
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="button-default secondary orange" (click)="closeModals()">
          Cerrar
        </button>
        <button class="button-default primary orange" (click)="validateform()">
          Continuar
        </button>
      </div>
    </section>
  </div>
</ng-template>

<ng-template #modalClienteEstado>
  <div class="content-modal modal-cliente-estado">
    <section>
      <div class="modal-header">
        <button (click)="closeModals()">&times;</button>
      </div>
      <div class="modal-body">
        <div>
          <img
            src="./assets/accidentes-personales/resources/mail-bloqueo-ruc.svg"
            alt="icono informacion"
          />
        </div>
        <p class="paragraph">
          Por favor comunícate al buzón:
          <span class="paragraph-mail"
            >comercialestado@protectasecurity.pe</span
          >
          Nuestros ejecutivos del canal Estado se comunicarán pronto contigo.
        </p>
      </div>
      <div class="modal-footer">
        <button class="button-default primary orange" (click)="closeModals()">
          Entendido
        </button>
      </div>
    </section>
  </div>
</ng-template>
